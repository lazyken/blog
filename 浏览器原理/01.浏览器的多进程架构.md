# 进程和线程

进程（process）和线程（thread）是操作系统的基本概念。

进程是 CPU 资源分配的最小单位，是能拥有资源和独立运行的最小单位。  
线程是 CPU 调度的最小单位，是建立在进程基础上的一次程序运行单位。

现代操作系统都是可以同时运行多个任务的,比如:用浏览器上网的同时还可以听音乐。  
对于操作系统来说,一个任务就是一个进程,比如打开一个浏览器就是启动了一个浏览器进程（准确的说，浏览器是多进程的，这里方便理解只是概括性的描述一下）,打开一个 Word 就启动了一个 Word 进程。  
有些进程同时不止做一件事,比如 Word,它同时可以进行打字、拼写检查、打印等事情。在一个进程内部,要同时做多件事,就需要同时运行多个“子任务”,我们把进程内的这些“子任务”称为线程。  
由于每个进程至少要做一件事,所以一个进程至少有一个线程。系统会给每个进程分配独立的内存,因此进程有它独立的资源。同一进程内的各个线程之间共享该进程的内存空间（包括代码段,数据集,堆等）。

# 浏览器的多进程架构

以 chrome 为例，它由多个进程组成,每个进程都有自己核心的职责,它们相互配合完成浏览器的整体功能。每个进程中又包含多个线程,一个进程内的多个线程也会协同工作,配合完成所在进程的职责。

- **浏览器主进程**：主要负责界面显示、用户交互、子进程管理，同时提供存储等功能。
- **网络进程**：主要负责页面的网络资源加载，之前是作为一个模块运行在浏览器主进程里面的，直至近年才独立出来，成为一个单独的进程。
- **渲染进程**：核心任务是将 HTML、CSS 和 JavaScript 转换为用户可以与之交互的网页，排版引擎 Blink 和 JavaScript 引擎 V8 都是运行在该进程中，默认情况下，Chrome 会为每一个 Tab 标签创建一个渲染进程，如果在 A 页面打开 B 页面，且 AB 页面属于同一站点（协议和根域名相同），则 B 页面仍然处于 A 页面的进程中。处于安全考虑，渲染进程都是运行在沙箱模式下。
- **GPU 进程**：其实，Chrome 刚开始发布的时候是没有 GPU 进程的。而 GPU 的使用初衷是为了实现 3DCSS 的效果，只是随后网页、Chrome 的 UI 界面都选择采用 GPU 来绘制，这使得 GPU 成为浏览器普遍的需求。最后，Chrome 在其多进程的架构上也引入了 GPU 进程。
- **插件进程**：主要是负责插件的运行，因插件易崩溃，所以需要通过插件进程来隔离，以保证插件崩溃不会对浏览器和页面造成影响。

在 Chrome 中开 1 个⻚⾯⾄少需要 1 个⽹络进程、1 个浏览器进程、1 个 GPU 进程以及 1 个渲染进程，共 4 个；如果打开的⻚⾯有运⾏插件的话，还需要再加上 1 个插件进程。

浏览器的多进程架构提升了浏览器的**稳定性**、**流畅性**和**安全性**；但也造成**更高的资源占用**和**更复杂的体系架构**
